<div class="slim-scroll padder-h" data-height="auto" data-disable-fade-out="true" data-distance="0" data-size="10px"
	data-railopacity="0.2">
	<div class="row m-b-md">
		<div class="col-lg-12">
			<app-titulo>Detalhe de Insumos {{titulo}}</app-titulo>
			<app-sub-titulo>{{tituloCorrecao}}Detalhamento do Insumo do tipo {{subtitulo}} </app-sub-titulo>
		</div>

		
	<div class="row">
		<div class="col-lg-12">

			<div class="pull-right" *ngIf="!somenteLeitura" style="margin-top: 5px; margin-right: 15px;">
				<a class="btn btn-sm btn-default" (click)="confirmaCancelar()"><i class="fa fa-times"></i>
					Cancelar
				</a>
			</div>
			<div class="pull-right" *ngIf="somenteLeitura" style="margin-top: 5px; margin-right: 15px;">
				<a class="btn btn-sm btn-default" (click)="cancelar()"><i class="fa fa-long-arrow-left m-r-xs"></i> Voltar</a>
			</div>

			<section class="panel panel-default">
				<header class="panel-heading">
					<h2 class="panel-title h5">Dados do Insumo</h2>
				</header>
				<article class="panel-body">
					<fieldset>
						<div class="row">
							<div class="col-lg-2">
								<label for="codigoInsumo" class="control-label text-nowrap">Cód. Insumo:</label>
								<input id="codigoInsumo" type="text" name="codigoInsumo" autocomplete="off"
									class="form-control" disabled="disabled" [(ngModel)]="modelInsumo.codigoInsumo" />
							</div>
							<div class="col-lg-10">
								<label for="descricaoInsumo" class="control-label text-nowrap">Descrição:</label>
								<input type="text" id="descricaoInsumo" name="descricaoInsumo" autocomplete="off"
									class="form-control" disabled="disabled"
									[(ngModel)]="modelInsumo.descricaoInsumo" />
							</div>
						</div>
						<div class="row">
							<div class="col-lg-12">
								<label for="descricaoEspecificacaoTecnica"
									class="control-label text-nowrap">Especificação Técnica:</label>
								<input id="descricaoEspecificacaoTecnica" type="text"
									name="descricaoEspecificacaoTecnica" autocomplete="off" class="form-control"
									disabled="disabled" [(ngModel)]="modelInsumo.descricaoEspecificacaoTecnica" />
							</div>
						</div>
						<div class="row">
							<div class="col-lg-2">
								<label for="tipoInsumo" class="control-label text-nowrap">Tipo:</label>
								<input id="tipoInsumo" type="text" name="tipoInsumo" autocomplete="off"
									class="form-control" disabled="disabled" [(ngModel)]="modelInsumo.tipoInsumo" />
							</div>
							<div class="col-lg-2">
								<label for="codigoNCM" class="control-label text-nowrap">NCM:</label>
								<input type="text" id="codigoNCM" name="codigoNCM" autocomplete="off"
									class="form-control" disabled="disabled" [(ngModel)]="modelInsumo.codigoNCM" />
							</div>
							<div class="col-lg-4">
								<label for="codigoUnidade" class="control-label text-nowrap">Unidade:</label>
								<input type="text" id="codigoUnidade" name="codigoUnidade" autocomplete="off"
									class="form-control" disabled="disabled" [(ngModel)]="modelInsumo.codigoUnidade" />
							</div>
							<div class="col-lg-4">
								<label for="valorCoeficienteTecnico" class="control-label text-nowrap">Coeficiente
									Técnico:</label>
								<input type="text" id="valorCoeficienteTecnico" name="valorCoeficienteTecnico"
									autocomplete="off" class="form-control" disabled="disabled"
									[(ngModel)]="modelInsumo.valorCoeficienteTecnico" />
							</div>
						</div>
						<div class="row">
							<div class="col-lg-4">
								<label for="descricaoPartNumber" class="control-label text-nowrap">Part Number:</label>
								<input id="descricaoPartNumber" type="text" name="descricaoPartNumber"
									autocomplete="off" class="form-control" [disabled]="somenteLeitura"
									[(ngModel)]="modelInsumo.descricaoPartNumber" />
							</div>
							<div class="col-lg-4">
								<label for="valorPercentualPerda" class="control-label text-nowrap">Percentual
									Perda(%):</label>
								<input id="valorPercentualPerda" type="number" name="valorPercentualPerda"
									autocomplete="off" class="form-control" [disabled]="somenteLeitura"
									[(ngModel)]="modelInsumo.valorPercentualPerda" />
							</div>
							<div class="col-lg-4">
								<label for="qtdMaximoInsumo" class="control-label text-nowrap">Qtd. Max. Insumo:</label>
								<input id="qtdMaximoInsumo" type="text" name="qtdMaximoInsumo" autocomplete="off"
									class="form-control" disabled="disabled" [(ngModel)]="parametros.qtdMaxima" />
							</div>
						</div>
					</fieldset>
				</article>
			</section>
		</div>

		<div class="col-lg-12">
			<section class="panel panel-default">
				<header class="panel-heading">
					<h2 class="panel-title h5">Dados do Detalhamento</h2>
				</header>
				<article class="panel-body">
					<fieldset>

						<fieldset class="m-b-lg" style="border: 1px solid #000; padding: 10px;">
							<legend style="width: auto; border: 0;">Valores Totais</legend>
							<div class="row form-group">
								<div class="col-lg-4">
									<label>Quantidade Total de Insumos:</label>
									<div class="ds-flex">
										<input type="text" class="form-control"
											[(ngModel)]="modelDetalhes.qtdTotalInsumosFormatada" disabled />
									</div>
								</div>
								<div class="col-lg-4" *ngIf="isQuadroNacional">
									<label>Vlr. Total de Insumos (R$):</label>
									<div class="ds-flex">
										<input type="text" class="form-control"
											[(ngModel)]="modelDetalhes.valorTotalInsumosFormatada" disabled />
									</div>
								</div>
							</div>
						</fieldset>

						<div class="row col-lg-12 form-group" *ngIf="isQuadroNacional && !isCorrecao">
							<div class="col-lg-4">
								<label>Quantidade:</label>
								<div class="ds-flex">
									<input [disabled]="somenteLeitura" type="text" class="form-control"
										[readonly]="somenteLeitura" maxlength="16" formatar-numero-decimal5
										[prefix]="' '" placeholder="0.00000" [(ngModel)]="parametros.qtd" />
								</div>
							</div>
							<div class="col-lg-4">
								<label>Valor Unitário (R$):</label>
								<div class="ds-flex">
									<input [disabled]="somenteLeitura" type="text" class="form-control"
										[readonly]="somenteLeitura" maxlength="18" formatar-numero-decimal7
										[prefix]="' '" placeholder="0.0000000" [(ngModel)]="parametros.valorUnitario" />
								</div>
							</div>
						</div>

						<div class="row col-lg-12 form-group" *ngIf="!isQuadroNacional && !isCorrecao">
							<div class="row">
								<div class="col-lg-4">
									<label>País:</label>
									<app-drop-list-select2 #pais id="pais"
										(valorModificado)="parametros.codigoPais = $event" name="pais" servico="Pais"
										[(ngModel)]="parametros.codigoPais" [isDisabled]="somenteLeitura"
										[placeholder]="somenteLeitura ? '' : 'Infome o código ou a descrição'">
									</app-drop-list-select2>
								</div>

								<div class="col-lg-4">
									<label for="descricao" class="">Moeda:</label>
									<app-drop-list-select #moeda id="moeda"
										(valorModificado)="parametros.idMoeda = $event" name="idMoeda" servico="Moeda"
										[selMinimumInputLength]="3" [isDisabled]="somenteLeitura"
										[placeholder]="somenteLeitura ? '' : 'Selecione uma opção'"
										[(ngModel)]="parametros.idMoeda">
									</app-drop-list-select>
								</div>
							</div>

							<div class="row">
								<div class="col-lg-4">
									<label>Quantidade:</label>
									<div class="ds-flex">
										<input type="text" class="form-control" [readonly]="somenteLeitura"
											maxlength="16" formatar-numero-decimal5 [prefix]="' '" placeholder="0.00000"
											[(ngModel)]="parametros.qtd" />
									</div>
								</div>
								<div class="col-lg-4">
									<label>Valor Unitário FOB:</label>
									<div class="ds-flex">
										<input type="text" class="form-control" [readonly]="somenteLeitura"
											maxlength="18" formatar-numero-decimal7 [prefix]="' '"
											placeholder="0.0000000" [(ngModel)]="parametros.valorUnitarioFOB" />
									</div>
								</div>

								<div class="col-lg-4">
									<label>Valor Frete(US$):</label>
									<div class="ds-flex">
										<input type="text" class="form-control" [readonly]="somenteLeitura"
											maxlength="18" formatar-numero-decimal7 [prefix]="' '"
											placeholder="0.0000000" [(ngModel)]="parametros.valorFrete" />
									</div>
								</div>
							</div>
						</div>

						<div class="pull-right m-b" *ngIf="!somenteLeitura && !isCorrecao">
							<button (click)="incluirDetalhe()" type="button" class="btn btn-sm btn-primary"><span
									class="fa fa-plus m-r-xs"></span>Incluir Item na Lista</button>
						</div>
						<form>
							<article class="panel-body">
								<div class="row">
									<table class="table table-striped" *ngIf="isQuadroNacional">
										<thead class="table-header-color">
											<tr>
												<th class="th-sortable unset-nowrap">
													<app-ordenacao field="NumeroPlano" [sorted]="sorted"
														(onChangeSort)="changeSort($event)">Quantidade</app-ordenacao>
												</th>
												<th class="th-sortable unset-nowrap">
													<app-ordenacao field="TipoModalidade" [sorted]="sorted"
														(onChangeSort)="changeSort($event)">Vlr. Unitário(R$)
													</app-ordenacao>
												</th>
												<th class="th-sortable unset-nowrap" *ngIf="isCorrecao">
													<app-ordenacao field="SituacaoAnalise" [sorted]="sorted"
														(onChangeSort)="changeSort($event)">Status</app-ordenacao>
												</th>
												<th class="text-center th-100" *ngIf="!somenteLeitura">Ações</th>
											</tr>
										</thead>

										<tbody *ngIf="listaDetalhes != 0">
											<tr *ngFor="let item of listaDetalhes">
												<td class="text-left">{{item.quantidadeFormatada}}</td>
												<td class="text-left">{{item.valorUnitarioFormatada}}</td>
												<td class="text-left" *ngIf="isCorrecao" [ngClass]="{'textGreen':item.situacaoAnalise == 1, 
																'textRed':item.situacaoAnalise == 2}">
													{{item.situacaoAnaliseString}}
												</td>
												<td class="text-center" *ngIf="!somenteLeitura">
													<b *ngIf="!isCorrecao">
														<a (click)="abrirModalAlterar(item)" class="btn btn-default btn-sm"
															data-toggle="tooltip" title="" data-original-title="Alterar"><i
																class="fa fa-pencil"></i>
														</a>
														<a (click)="confirmarExclusaoDetalhe(item)"
															class="btn btn-danger btn-sm" data-toggle="tooltip" title=""
															data-original-title="Excluir"><i class="fa fa-trash-o"></i>
														</a>
														<a (click)="abrirModalJustificativaErro(item)" 
															class="btn btn-default btn-sm" data-toggle="tooltip" title="" 
															data-original-title="Justificativa de Erro">
															<i class="fa fa-comment-o"></i>
														</a>
													</b>
													<b *ngIf="isCorrecao && (item.situacaoAnalise == 2 || item.situacaoAnalise == 4)">
														<a (click)="abrirModalAlterar(item)"
															class="btn btn-default btn-sm" data-toggle="tooltip" title=""
															data-original-title="Corrigir">
															<i class="fa fa-pencil"></i>
														</a>
														<a (click)="confirmarInativacao(item)"
															class="btn btn-danger btn-sm" data-toggle="tooltip" title=""
															data-original-title="Inativar">
															<i class="fa fa-trash-o"></i>
														</a>
													</b>
												</td>
											</tr>
										</tbody>
										<tbody *ngIf="listaDetalhes == 0">
											<td colspan="4" class="text-center" style="font-weight: bold;">Nenhum
												registro encontrado.</td>
										</tbody>

									</table>
									<table class="table table-striped" *ngIf="!isQuadroNacional">
										<thead class="table-header-color">
											<tr>
												<th class="th-sortable unset-nowrap">
													<app-ordenacao field="NumeroPlano" [sorted]="sorted"
														(onChangeSort)="changeSort($event)">País</app-ordenacao>
												</th>
												<th class="th-sortable unset-nowrap">
													<app-ordenacao field="NumeroPlano" [sorted]="sorted"
														(onChangeSort)="changeSort($event)">Moeda</app-ordenacao>
												</th>
												<th class="th-sortable unset-nowrap">
													<app-ordenacao field="NumeroPlano" [sorted]="sorted"
														(onChangeSort)="changeSort($event)">Quantidade</app-ordenacao>
												</th>
												<th class="th-sortable unset-nowrap">
													<app-ordenacao field="TipoModalidade" [sorted]="sorted"
														(onChangeSort)="changeSort($event)">Vlr. Unitário(FOB)
													</app-ordenacao>
												</th>
												<th class="th-sortable unset-nowrap">
													<app-ordenacao field="TipoExportacao" [sorted]="sorted"
														(onChangeSort)="changeSort($event)">Valor Frete(US$)
													</app-ordenacao>
												</th>
												<th class="th-sortable unset-nowrap" *ngIf="isCorrecao">
													<app-ordenacao field="SituacaoAnalise" [sorted]="sorted"
														(onChangeSort)="changeSort($event)">Status</app-ordenacao>
												</th>
												<th class="text-center th-150" *ngIf="!somenteLeitura">Ações</th>
											</tr>
										</thead>

										<tbody *ngIf="listaDetalhes != 0">
											<tr *ngFor="let item of listaDetalhes">
												<td class="text-left">{{item.codigoPais}} | {{item.descricaoPais}}</td>
												<td class="text-left">{{item.codigoMoeda}} | {{item.descricaoMoeda}}</td>
												<td class="text-left">{{item.quantidadeFormatada}}</td>
												<td class="text-left">{{item.valorUnitarioFormatada}}</td>
												<td class="text-left">{{item.valorFreteFormatada}}</td>
												<td class="text-left" *ngIf="isCorrecao" [ngClass]="{'textGreen':item.situacaoAnalise == 1, 
																'textRed':item.situacaoAnalise == 2}">
													{{item.situacaoAnaliseString}}
												</td>
												<td class="text-center" *ngIf="!somenteLeitura">
													<b *ngIf="!isCorrecao">
														<a (click)="abrirModalAlterar(item)" class="btn btn-default btn-sm"
															data-toggle="tooltip" title="" data-original-title="Alterar"><i
																class="fa fa-pencil"></i>
														</a>
														<a (click)="confirmarExclusaoDetalhe(item)"
															class="btn btn-danger btn-sm" data-toggle="tooltip" title=""
															data-original-title="Excluir"><i class="fa fa-trash-o"></i>
														</a>
													</b>

													<b *ngIf="isCorrecao && (item.situacaoAnalise == 2 || item.situacaoAnalise == 4)">
														<a (click)="abrirModalJustificativaErro(item)" 
															class="btn btn-default btn-sm" data-toggle="tooltip" title="" 
															data-original-title="Justificativa de Erro">
															<i class="fa fa-comment-o"></i>
														</a>
														<a (click)="abrirModalAlterar(item)"
															class="btn btn-default btn-sm" data-toggle="tooltip" title=""
															data-original-title="Corrigir">
															<i class="fa fa-pencil"></i>
														</a>
														<a (click)="confirmarInativacao(item)"
															class="btn btn-danger btn-sm" data-toggle="tooltip" title=""
															data-original-title="Inativar">
															<i class="fa fa-trash-o"></i>
														</a>
													</b>
												</td>
											</tr>
										</tbody>
										<tbody *ngIf="listaDetalhes == 0">
											<td colspan="4" class="text-center" style="font-weight: bold;">Nenhum
												registro encontrado.</td>
										</tbody>


									</table>
								</div>
							</article>
						</form>


					</fieldset>
				</article>
				<footer class="panel-footer clearfix" style="padding: 4px 15px!important;">
					<div class="pull-right" *ngIf="!somenteLeitura">
						<a class="btn btn-sm btn-default" (click)="confirmaCancelar()"><i class="fa fa-times"></i>
							Cancelar</a>
						<a class="btn btn-primary btn-sm" (click)="alterarInsumo()"><i
								class="fa fa-check"></i>Salvar</a>
					</div>
					<div class="pull-right" *ngIf="somenteLeitura">
						<a class="btn btn-sm btn-default" (click)="cancelar()"><i class="fa fa-times"></i> Cancelar</a>
					</div>
				</footer>
			</section>
		</div>

	</div>
</div>
<app-modal-editar-detalhe-insumo #appModalEditarDetalheInsumo></app-modal-editar-detalhe-insumo>
<app-modal-justificativa-erro #modalJustificativaErro></app-modal-justificativa-erro>